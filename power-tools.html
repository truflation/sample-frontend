<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Truflation power tools</title>
  <link rel="shortcut icon" href="./favicon.ico"/>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.3/web3.min.js"></script>
  <script src="./abi.js"></script>
  <script src="./index.js"></script>
  <script type="text/javascript">
     async function getMartianAleIndex() {
       let oracleAddress = document.querySelector('#oracle\\:address')
       oracleAddress = oracleAddress ? oracleAddress.value : undefined
       doOracleRequest({
         "address": oracleAddress,
         "service": "stub1",
         "keypath": "martianale",
         "abi": "json",
         "data": '{"range": [0, 100], "indexes": ["martianale"]}',
       }, {
         "output":  document.querySelector('#martianale\\:output'),
         "status": document.querySelector('#martianale\\:status')
       })
     }

    async function runOracle() {
      let oracleAddress = document.querySelector('#oracle\\:address')
      let oracleService = document.querySelector('#oracle\\:service')
      let oracleKeypath = document.querySelector('#oracle\\:keypath')
      let oracleAbi = document.querySelector('#oracle\\:abi')
      let oracleMultiplier = document.querySelector('#oracle\\:multiplier')
      let oracleData = document.querySelector('#oracle\\:data')
      console.log(oracleAddress)

      doOracleRequest({
        "address": oracleAddress ? oracleAddress.value : "",
        "service": oracleService ? oracleService.value : "",
        "keypath": oracleKeypath ? oracleKeypath.value : "",
        "abi": oracleAbi ? oracleAbi.value : "",
        "multiplier": oracleMultiplier ? oracleMultiplier.value : "",
        "data": oracleData ? oracleData.value : "",
      }, {
        "output": document.querySelector('#oracle\\:output'),
        "status": document.querySelector('#oracle\\:status')
      })
    }
    async function getEchoValues() {
      document.querySelector('#oracle\\:service').value = "echo"
      document.querySelector('#oracle\\:keypath').value = "foo"
      document.querySelector('#oracle\\:abi').value = "json"
      document.querySelector('#oracle\\:data').value = '{"foo": 1024}'
      document.querySelector('#oracle\\:multiplier').value = ''
    }
    async function getStubValues() {
      document.querySelector('#oracle\\:service').value = "stub1"
      document.querySelector('#oracle\\:keypath').value = "martianale"
      document.querySelector('#oracle\\:abi').value = "json"
      document.querySelector('#oracle\\:data').value =
        '{"range": [0, 100], "indexes": ["martianale"]}'
      document.querySelector('#oracle\\:multiplier').value = ''
    }
    async function getInflationValues() {
      document.querySelector('#oracle\\:service').value = "truflation/current"
      document.querySelector('#oracle\\:keypath').value = ''
      document.querySelector('#oracle\\:abi').value = "json"
      document.querySelector('#oracle\\:data').value = ''
      document.querySelector('#oracle\\:multiplier').value = ''
    }
  </script>
</head>
<body>
  <h1>Truflation power tools</h1>
  <a href="https://discord.com/channels/967280164071407666/968071680360587264"
     target="_blank">Truflation
    developer chat</a><br/>
  <a href="https://github.com/truflation/sample-frontend/"
     target="_blank">
    Source code</a>
  <p />
  <button class="enableEthereumButton">Connect wallet</button><br />
  Account: <span class="showAccount"></span><br />
  Chain: <span class="showChain"></span><br><br />
  Oracle address:
  <input type="text" size="50" id="oracle:address"
	 value=""
	 /><br />
  <br />
  <section id="stub-example">
    <h3>Stub example</h3>
      <button type="button" onClick="getMartianAleIndex()">
      Martian ale index
    </button>
    <br />
    <span id="martianale:output"></span><br />
    <span id="martianale:status"></span>
  </section>
  <p />

  <section id="api-tester">
    <h3>API Tester</h3>
    <button type="button" onClick="getEchoValues()">
      Get Echo Values
    </button>
    <button type="button" onClick="getStubValues()">
      Get Stub Values
    </button>
    <button type="button" onClick="getInflationValues()">
      Get Inflation Values
    </button><br />
    Service: <input type="text" size="50" id="oracle:service" /><br />
    Keypath: <input type="text" size="50" id="oracle:keypath" /><br />
    Abi: <input type="text" size="50" id="oracle:abi" /><br />
    Multiplier: <input type="text" size="50" id="oracle:multiplier" /><br />
    Data:<br> <textarea id="oracle:data"></textarea><br />
    <button type="button" onClick="runOracle();">Run
      Oracle</button><br />
    <span id="oracle:output"></span><br />
    <span id="oracle:status"></span>
  </section>

  <a href="power-tools.html">Power tools</a> 
</body>
</html>
