<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Truflation api tester</title>
  <link rel="shortcut icon" href="./favicon.ico"/>
  <script type="text/javascript"
	  src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.3/web3.min.js"></script>
  <script src='https://unpkg.com/cbor-web'></script>
  <script src="./config.js"></script>
  <script src="./abi.js"></script>
  <script src="./index.js"></script>
  <script type="text/javascript">
    async function runApi() {
      let apiAddress = document.querySelector('#api\\:address')
      let apiService = document.querySelector('#api\\:service')
      let apiKeypath = document.querySelector('#api\\:keypath')
      let apiAbi = document.querySelector('#api\\:abi')
      let apiMultiplier = document.querySelector('#api\\:multiplier')
      let apiData = document.querySelector('#api\\:data')
      console.log(apiAddress)

      doApiRequest({
        "address": apiAddress ? apiAddress.value : "",
        "service": apiService ? apiService.value : "",
        "keypath": apiKeypath ? apiKeypath.value : "",
        "abi": apiAbi ? apiAbi.value : "",
        "multiplier": apiMultiplier ? apiMultiplier.value : "",
        "data": apiData ? apiData.value : "",
      }, {
        "output": document.querySelector('#api\\:output'),
        "status": document.querySelector('#api\\:status')
      })
    }
    async function getEchoValues() {
      document.querySelector('#api\\:service').value = "echo"
      document.querySelector('#api\\:keypath').value = "foo"
      document.querySelector('#api\\:abi').value = "json"
      document.querySelector('#api\\:data').value = '{"foo": 1024}'
      document.querySelector('#api\\:multiplier').value = ''
    }
    async function getEchoWeiValues() {
      document.querySelector('#api\\:service').value = "echo"
      document.querySelector('#api\\:keypath').value = "foo"
      document.querySelector('#api\\:abi').value = "uint256"
      document.querySelector('#api\\:data').value = '{"foo": 1024.25}'
      document.querySelector('#api\\:multiplier').value =
        '1000000000000000000'
    }
    async function getStubValues() {
      document.querySelector('#api\\:service').value = "stub1"
      document.querySelector('#api\\:keypath').value = "martianale"
      document.querySelector('#api\\:abi').value = "json"
      document.querySelector('#api\\:data').value =
        '{"range": [0, 100], "indexes": ["martianale"]}'
      document.querySelector('#api\\:multiplier').value = ''
    }
    async function getInflationCurrentValues() {
      document.querySelector('#api\\:service').value = 'truflation/current'
      document.querySelector('#api\\:keypath').value = ''
      document.querySelector('#api\\:abi').value = 'json'
      document.querySelector('#api\\:data').value = ''
      document.querySelector('#api\\:multiplier').value = ''
    }
    async function getInflationAtDateValues() {
      document.querySelector('#api\\:service').value = 'truflation/at-date'
      document.querySelector('#api\\:keypath').value = ''
      document.querySelector('#api\\:abi').value = 'json'
      document.querySelector('#api\\:data').value = '{"date": "2021-10-05"}'
      document.querySelector('#api\\:multiplier').value = ''
    }
    async function getInflationRangeValues() {
      document.querySelector('#api\\:service').value = "truflation/range"
      document.querySelector('#api\\:keypath').value = ''
      document.querySelector('#api\\:abi').value = "ipfs"
      document.querySelector('#api\\:data').value = '{"interval": "day","start-date": "2021-01-01", "end-date": "2021-01-02"}'
      document.querySelector('#api\\:multiplier').value = ''
    }
    async function getNftValues() {
      document.querySelector('#api\\:service').value = "nft-index"
      document.querySelector('#api\\:keypath').value = ''
      document.querySelector('#api\\:abi').value = "json"
      document.querySelector('#api\\:data').value = '{"index": "top11"}'
      document.querySelector('#api\\:multiplier').value = ''
    }
  </script>
</head>
<body>
  <h1>API Tester</h1>
  <a href="https://discord.com/channels/967280164071407666/968071680360587264"
     target="_blank">Truflation
    developer chat</a><br/>
  <a href="https://github.com/truflation/sample-frontend/"
     target="_blank">
    Source code</a>
  <p />
  <button class="enableEthereumButton">Connect wallet</button><br />
  Account: <span class="showAccount"></span><br />
  Chain: <span class="showChain"></span><br><br />
  API client address:
  <input type="text" size="50" id="api:address"
	 value=""
	 />
  (<a href="https://remix.ethereum.org/#url=https://raw.githubusercontent.com/truflation/sample-frontend/main/ApiClient.sol">Show
  API Contract</a>)
  <br />
  <section id="api-tester">
    <button type="button" onClick="getInflationCurrentValues()">
      Get Current Inflation Values
    </button>
    <button type="button" onClick="getInflationAtDateValues()">
      Get Inflation at date Values
    </button>
    <button type="button" onClick="getInflationRangeValues()">
      Get Inflation range Values
    </button>
    <br />
    <button type="button" onClick="getEchoValues()">
      Get Echo Values
    </button>
    <button type="button" onClick="getEchoWeiValues()">
      Get Echo Value in wei
    </button>
    <button type="button" onClick="getStubValues()">
      Get Stub Values
    </button>
    <button type="button" onClick="getNftValues()">
      Get NFT Values
    </button>
    <br />
    <br />
    Service: <input type="text" size="50" id="api:service" /><br />
    Keypath: <input type="text" size="50" id="api:keypath" /><br />
    Abi: <input type="text" size="50" id="api:abi" /><br />
    Multiplier: <input type="text" size="50" id="api:multiplier" /><br />
    Data:<br> <textarea id="api:data"></textarea><br />
    <button type="button" onClick="runApi();">Run
      Api</button><br />
    <span id="api:output"></span><br />
    <span id="api:status"></span>
  </section>

  <a href="power-tools.html">Power tools</a> 
</body>
</html>
